
@{
    ViewBag.Title = "MailIndex";
    Layout = "~/Views/Shared/_Layout.cshtml";
    
}



<style>
    #tbody_filter {
    }

    .add_btn {
        width: 20px;
        padding: 2px;
        height: 20px;
        margin-left: -16px;
    }
</style>

<script src="~/AxonScripts/HouseKeeping/Mail.js?v=@DateTime.UtcNow.ToString()"></script>
<script src="~/Scripts/jquery.min.js"></script>
<!-- page content -->
<div class="right_col" role="main">
    <div class="">
        <div class="clearfix"></div>
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>MAIL</h2>

                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="container">
                            @*<h2>Departments Record</h2>*@
                          @*  @if (ViewBag.BuyerAddFlag == "true")
                            {
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" data-backdrop="static" data-keyboard="false" onclick="clearTextBox();">Add New Buyer</button>
                            }
                            else
                            {
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" data-backdrop="static" data-keyboard="false" disabled>Add New Buyer</button>
                            }*@
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" data-backdrop="static" data-keyboard="false" onclick="clearTextBox();">Add New Buyer</button>
                            <table id="tbody" class="table table-bordered table-hover">
                                @*<thead>
                                    <tr>
                                        <th style="visibility: hidden;">ID
                                        </th>
                                        <th>Buyer Name
                                        </th>
                                        <th>Address
                                        </th>
                                        <th>City
                                        </th>
                                        <th>Status
                                        </th>
                                        <th>Action
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="tbody">
                                </tbody>*@
                            </table>
                        </div>
                    
            <link href="~/build/Login/jquery.dataTables.min.css" rel="stylesheet">
            @* Load datatable js *@
            @section Scripts{

                <script src="~/build/js/jquery.dataTables.min.js"></script>
                <script>
                                           
                </script>

            }


                        

                        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">

                                 

                                <div class="x_panel" style="width: 102%;">
                                    <div class="x_title">
                                        <h2>Add Buyer</h2>
                                        <ul class="nav navbar-right panel_toolbox">
                                          
                                        </ul>
                                        <div class="clearfix"></div>
                                    </div>

                                    <div class="modal-body row">
                                        <div class="x_panel">
                                            <div class="row">
                                                <div class="row">
                                                    <div class="col-md-9 col-sm-9 col-xs-12">

                                                        @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <table border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td style="width: 80px">To:</td>
                <td>@Html.TextBoxFor(m => m.To)</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Subject:</td>
                <td>@Html.TextBoxFor(m => m.Subject)</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td valign="top">Body:</td>
                <td>@Html.TextAreaFor(m => m.Body, new { @rows = 10, @cols = 50 })</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>File Attachment:</td>
                <td><input type="file" name="Attachments" multiple="multiple"/></td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Gmail Email:</td>
                <td>@Html.TextBoxFor(m => m.Email)</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>Gmail Password:</td>
                <td>@Html.PasswordFor(m => m.Password)</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td></td>
                <td><input type="submit" value="Send"/></td>
            </tr>
        </table>
    }






                                                     @*   <form class="form-horizontal form-label-left input_mask">
                                                            <div class="form-group">
                                                                <label class="control-label col-md-4 col-sm-4 col-xs-12">From Mail<span style="color: red;"> *</span></label>
                                                                <div class="col-md-8 col-sm-8 col-xs-12">
                                                                    <input type="text" id="txtFrommail" placeholder="From mail" class="form-control col-md-10">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="control-label col-md-4 col-sm-4 col-xs-12">Password<span style="color: red;"> *</span> </label>
                                                                <div class="col-md-8 col-sm-8 col-xs-12">
                                                                    <input type="text" id="txtPassword" placeholder="Password" class="form-control col-md-10">
                                                                </div>

                                                            </div>

                                                            <div class="form-group">
                                                                <label class="control-label col-md-4 col-sm-4 col-xs-12">To Mail<span style="color: red;"> *</span></label>
                                                                <div class="col-md-8 col-sm-8 col-xs-12">
                                                                    <input type="text" id="txtTomail" placeholder="To Mail" class="form-control col-md-10" >
                                                                </div>

                                                            </div>

                                                            <div class="form-group">
                                                                <label class="control-label col-md-4 col-sm-4 col-xs-12">Subject</label>
                                                                <div class="col-md-8 col-sm-8 col-xs-12">
                                                                    <input type="text" id="txtSubject" placeholder="Subject" class="form-control col-md-10" >
                                                                </div>

                                                            </div>

                                                            <div class="form-group">
                                                                <label class="control-label col-md-4 col-sm-4 col-xs-12">Message</label>
                                                                <div class="col-md-8 col-sm-8 col-xs-12">
                                                                  <textarea id="txtBody" style="width: 319px;height: 130px;" placeholder="..."></textarea>
                                                                </div>

                                                            </div>


 



                                                        </form>*@

                                                    </div>
                                                   
                                                </div>

                                               @*  <div class="col-md-7 col-sm-6 col-xs-12" style="border: 1px solid #dacfcf;">

                                                                            <div class="row" style="margin: 0;">
                                                                                <h4>Attachment</h4>
                                                                            </div>
                                                                            @using (Html.BeginForm("Upload", "StyleEntry", FormMethod.Post,
                                                                                    new
                                                                                    {
                                                                                        enctype = "multipart/form-data",
                                                                                        id = "ImgForm",
                                                                                        name = "ImgForm",
                                                                                        target = "UploadTarget"


                                                                                    }))
                                                                            { 

                                                                                       
                                                                                @Html.Hidden("ID", 1)
                                                                                    


                                                                                <div class="x_panel">
                                                                                    <div class="row" style="float: left;">
                                                                                        <form class="form-horizontal form-label-left input_mask">
                                                                                            <div class="form-group" style="margin-bottom: 15px;">
                                                                                                <div class="col-md-4 col-sm-4 col-xs-12">
                                                                                                    <input type="text" id="txttitle" name="TitleVal" class="form-control" placeholder="Title">
                                                                                                </div>
                                                                                                <div class="col-md-5 col-sm-5 col-xs-12">
                                                                                                    <input type="file" id="uploadFile" name="file" data-val="true" class="form-control" data-val-required="please select a file" />
                                                                                                    <span id="validityMessages" style="color: Red;"></span>
                                                                                                </div>
                                                                                                <div class="col-md-3 col-sm-3 col-xs-12">
                                                                                                    <input id="upload" type="button" value="Upload" name="Upload" onclick="UploadImage();" class="btn btn-primary" />
                                                                                                </div>
                                                                                                <br />
                                                                                            </div>
                                                                                        </form>
                                                                                        <div class="row">
                                                                                            <div id="uploadsContainer" style="margin-left: 22px;"></div>
                                                                                            <iframe id="UploadTarget" name="UploadTarget" onload="UploadImage_Complete();" style="position: absolute; left: -999em; top: -999em;"></iframe>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                            }
                                                                        </div>*@
                                            </div>
                                       
                                        </div>




                                    </div>

                                    <div class="form-group">
                                        <span class="text-muted"><em><span style="color: red;">*</span> Indicates required field</em></span>
                                    </div>
                                    <div class="modal-footer" style="border: 0px solid">
                                        <button type="button" class="btn btn-success" id="btnAdd" onclick="return  sentmail();">Send</button>
                                        <button type="button" class="btn btn-success" id="btnUpdate" style="display: none;" onclick="Update();">Update</button>
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                    </div>
                                </div>



                                


                            </div>
                        </div>






                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    $(document).ready(function () {
        debugger;
        $('.delUpload').on('click', function () {
            var Id = this.id;
            var url = "/StyleEntry/DeleteFile";
            url = url + "?id=" + Id
            $.get(url, function (response) {
                $('#uploadsContainer').html(response);
            });
        });
    });

    function deletefile(id) {
        debugger;
        var Id = id;
        var url = "/StyleEntry/DeleteFile";
        url = url + "?id=" + Id
        $.get(url, function (response) {
            $('#uploadsContainer').html(response);
            nametxt = GetFilelist();
        });

        //var filterlst = $.grep(nametxt, function (item) {
        //    return item.FileID != id;
        //});

        //nametxt = filterlst;

    }
    //function Viewfile(id) {
    //    debugger;
    //    var Id = id.toString();
    //    var imgid=Id.SubString(4);
    //    var url = "/StyleEntry/DeleteFile";
    //    url = url + "?id=" + Id
    //    $.get(url, function (response) {
    //        $('#uploadsContainer').html(response);
    //        nametxt = GetFilelist();
    //    });


    //}
</script>



<script type="text/javascript">
    var isFirstLoad = true;
    var nametxt = [];
    var title = [];

    function UploadImage() {
        debugger;
        if ($('#imgid').attr('src') != undefined) {
            alert('Please Remove Old Logo...');
            return true;
        }
        if ($('#txttitle').val().trim() == "") {
            alert('Please fill the title...');
            return true;
        }
        // check for size of file not greater than 1MB
        if ($("#uploadFile").val()) {

            var iSize = ($("#uploadFile")[0].files[0].size / 1024);
            iSize = (Math.round((iSize / 1024) * 100) / 100);
            if (iSize > 4) {
                alert("File must be less than 4MB");
                $('span#validityMessages').html("File must be less than 4MB");
                return;
            }
            else {
                // on form post showing Busy Indicator
                $('#uploadLoader').show();
                $("#ImgForm").submit();
                console.log(iSize + "Mb");
                var fd = $("#uploadFile")[0].files[0].name;

                //nametxt.push(fd);
                title.push($('#txttitle').val());
            }
        }
            // check for no file selected for upload
        else {
            $('span#validityMessages').html("Please select a File of size less than 4MB!");
            return;
        }

    }

    function UploadImage_Complete() {
        debugger;
        //Check to see if this is the first load of the iFrame
        if (isFirstLoad == true) {
            isFirstLoad = false;
            // if first ajax call for getting uploads if any exists on server against this id 
        }

        // after successfull upload refreshing partial view to get the latest uploads
        $('#uploadLoader').hide();

        //Reset the image form so the file won't get uploaded again
        document.getElementById("ImgForm").reset();

        //if (!isFirstLoad)
        //    GetFiles();
        nametxt = GetFilelist();
        GetFiles();

    }



    function GetFiles() {
        debugger;

        var url = "/StyleEntry/GetFiles";
        var Id = $('input#ID').val();
        url = url + "?id=" + Id
        $.get(url, function (response) {
            $('#uploadsContainer').html(response);
        });
    }

    function GetFilelist() {
        debugger;
        var url = "/StyleEntry/GetFilelist";
        var Id = $('input#ID').val();
        url = url + "?id=" + Id
        $.get(url, function (response) {
            debugger;
            nametxt = response;
        });
    }

</script>
<!-- /page content -->


